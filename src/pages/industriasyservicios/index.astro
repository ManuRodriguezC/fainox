---
import LayoutPage from "../../layouts/LayoutPage.astro";
import { industrias } from "../../store/industrias";
import { productos } from "../../store/productos"
import Producto from "../../components/industrias/producto.astro";
import ArrowRight from "../../icons/arrowRight.astro";
import ArrowLeft from "../../icons/arrowLeft.astro";
---

<LayoutPage title="Fainox Group en todas las industrias">
  <div class="flex flex-col gap-10 px-5 lg:px-10">
    <div>
      <h1 class="font-bold text-colorBlue text-4xl">
        Fainox Group
      </h1>
      <p class="text-xl text-gray-600 mt-2">Conoce los productos por cada sector o industria</p>
    </div>
    {
      industrias.map((industry, index) => {
        const productsInIndustry = productos.filter((product) =>
          product.industry.includes(industry)
        );
        return (
          <div class="flex flex-col">
            <a
              href={`/industrias/${industry}`}
              class="w-full underline text-3xl font-semibold text-colorBlue px-4 py-2"
            >
              Industria - {industry}
            </a>
            <div class="w-95vw flex flex-row justify-between items-center">
              <button id={`left-${index}`} class="hidden md:block md:w-[5%] h-28 hover:scale-105 transition-all duration-100 left no-display">
                <ArrowLeft />
              </button>

              <div
                id={`product-container-${index}`}
                class="flex flex-row gap-4 overflow-y-hidden scroll-hidden p-6 pr-96 w-full md:w-[74%] lg:w-[85%]"
              >
                {productsInIndustry.map((productFilter) => (
                  <Producto {...productFilter} />
                ))}
              </div>

              <button id={`right-${index}`} class="hidden md:block md:w-[5%] w-[5%] h-28 hover:scale-105 transition-all duration-100 right">
                <ArrowRight />
              </button>
            </div>
          </div>
        );
      })
    }
  </div>

  <script>
    const rightButtons = document.querySelectorAll(".right");

    rightButtons.forEach((element, index) => {
      let scrollInterval: any;

      element.addEventListener("mouseenter", () => {
        const productContainer = document.getElementById(
          `product-container-${index}`
        );

        scrollInterval = setInterval(() => {
          if (productContainer) {
            const { scrollLeft, scrollWidth, clientWidth } = productContainer
            const curButtonLeft = document.getElementById(`left-${index}`)
            const curButtonRight = document.getElementById(`right-${index}`)

            productContainer?.scrollBy({
              top: 0,
              left: 300,
              behavior: "smooth",
            });

            if (scrollLeft > 0) {
              if (curButtonLeft) {
                curButtonLeft.classList.remove('no-display')
              }
            }
            if (clientWidth + scrollLeft >= scrollWidth - 250) {
              if (curButtonRight) {
                curButtonRight.classList.add('no-display')
              }
            }
          }
        }, 500);
      });

      element.addEventListener("mouseleave", () => {
        clearInterval(scrollInterval);
      });
    });

    const leftButtons = document.querySelectorAll(".left");

    leftButtons.forEach((element, index) => {
      let scrollInterval: any;

      element.addEventListener("mouseenter", () => {
        const productContainer = document.getElementById(
          `product-container-${index}`
        );

        scrollInterval = setInterval(() => {
          if (productContainer) {

            const { scrollLeft } = productContainer
            const curButtonLeft = document.getElementById(`left-${index}`)
            const curButtonRight = document.getElementById(`right-${index}`)

            productContainer?.scrollBy({
              top: 0,
              left: -300,
              behavior: "smooth",
            });

            if (scrollLeft == 0) {
              if (curButtonLeft) {
                curButtonLeft.classList.add('no-display')
              }
            }
            if (scrollLeft > 0) {
              if (curButtonRight) {
                curButtonRight.classList.remove('no-display')
              }
            }
          }
        }, 500);

      });

      element.addEventListener("mouseleave", () => {
        clearInterval(scrollInterval);
      });
    });
  </script>
</LayoutPage>
